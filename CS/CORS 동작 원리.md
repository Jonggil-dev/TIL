# CORS λ™μ‘ μ›λ¦¬

### β”CORS(Cross-Origin Resource Sharing) κΈ°λ³Έ μ΄ν•΄

- CORSλ” **!!!!!μ›Ή λΈλΌμ°μ €!!!!!**κ°€ λ‹¤λ¥Έ μ¶μ²μ λ¦¬μ†μ¤μ— μ•μ „ν•κ² μ ‘κ·Όν•  μ μλ„λ΅ ν•λ” λ³΄μ• λ©”μ»¤λ‹μ¦μ…λ‹λ‹¤.
- **μ‰½κ² μ›Ή νμ΄μ§€μ—μ„ λ°μƒν•λ” μ”μ²­μ μ¶λ°μ§€μ™€, μ”μ²­μ„ λ°›μ€ μ„λ²„μ λ„λ©”μΈμ΄ λ‹¤λ¥Ό κ²½μ°μ— CORS μ—λ¬κ°€ λ°μƒν•¨** 
  - μ΄ λ•, **μ”μ²­μ μ¶λ°μ§€λ” μ”μ²­μ„ λ³΄λ‚΄λ” μ›Ή νμ΄μ§€κ°€ λ΅λ“λ λ„λ©”μΈμ„ κΈ°μ¤€μΌλ΅ κ²°μ •** λ¨
  - μ‚¬μ©μκ°€ λΈλΌμ°μ €μ μ£Όμ†μ°½μ— **μ§μ ‘ URLμ„ μ…λ ¥ν•λ” κ²½μ°, CORS μ—λ¬ λ°μƒν•μ§€ μ•μ** (μ”μ²­μ μ¶λ°μ§€ λ„λ©”μΈμ΄ μ—†μΌλ―€λ΅)
    - **λ™μ  μ”μ²­:** `https://example.com`μ—μ„ λ΅λ“λ μ›Ή νμ΄μ§€κ°€ μλ°”μ¤ν¬λ¦½νΈλ¥Ό ν†µν•΄ `https://example.com:5040`μ— λ°μ΄ν„°λ¥Ό μ”μ²­ν•λ” κ²½μ°, μ΄λ” λ™μ  μ”μ²­μΌλ΅ κ°„μ£Όλ©λ‹λ‹¤. μ΄λ• μ”μ²­μ μ¶λ°μ§€λ” μ›λ νμ΄μ§€κ°€ λ΅λ“λ λ„λ©”μΈ(`https://example.com`)μ΄ λ©λ‹λ‹¤. ν¬νΈ λ²νΈκ°€ λ‹¤λ¥΄κΈ° λ•λ¬Έμ—, μ΄ μ”μ²­μ€ CORS μ •μ±…μ μ μ©μ„ λ°›μ.
    - **μ§μ ‘ μ…λ ¥:**  `https://example.com`μ—μ„ λ΅λ“λ μ›Ή νμ΄μ§€μ—μ„ μ‚¬μ©μκ°€ λΈλΌμ°μ €μ μ£Όμ†μ°½μ— `https://example.com:5040`μ„ μ§μ ‘ μ…λ ¥ν•κ³  μ ‘μ†ν•λ” κ²½μ°, CORS μ—λ¬ λ°μƒν•μ§€ μ•μ. μ΄ κ²½μ°, μƒλ΅μ΄ μ›Ή νμ΄μ§€ μ”μ²­μ΄λ―€λ΅, μ΄μ „ νμ΄μ§€ (`https://example.com`)μ™€λ” λ³„κ°λ΅ μ²λ¦¬λ©λ‹λ‹¤.

- μ›Ή λΈλΌμ°μ €λ” **μ„λ²„λ΅λ¶€ν„° λ°›μ€ μ‘λ‹µμ CORS κ΄€λ ¨ ν—¤λ”(`Access-Control-Allow-Origin` λ“±)λ¥Ό κ²€μ‚¬**ν•μ—¬, μ”μ²­μ΄ λ™μΌ μ¶μ² μ •μ±…μ— λ¶€ν•©ν•λ”μ§€λ¥Ό νλ‹¨ν•©λ‹λ‹¤.
- CORS μ •μ±… μ„λ° μ‹, μ›Ή λΈλΌμ°μ €λ” μ‘λ‹µ μ²λ¦¬λ¥Ό μ°¨λ‹¨ν•©λ‹λ‹¤. μ„λ²„ μΈ΅ μ²λ¦¬(λ°μ΄ν„°λ² μ΄μ¤ μ‘μ—… λ“±)μ—λ” μν–¥μ„ μ£Όμ§€ μ•μµλ‹λ‹¤.



### β½ CORS μ²λ¦¬μ— λ€ν• μ „μ²΄ νλ¦„

- κΈ°λ³Έμ μΌλ΅  CORSμ— λ€ν• κ²€μ‚¬λ” **`μ‚¬μ „ μ”μ²­(client) -> μ‚¬μ „ μ”μ²­ μ‘λ‹µ(server) -> μ‹¤μ  μ”μ²­(client) -> μ‹¤μ  μ”μ²­ μ‘λ‹µ(server)`** μμ„λ΅ μ΄λ£¨μ–΄μ§

  - μ΄ λ•, **μ‚¬μ „ μ”μ²­μ€ νΉμ • μ΅°κ±΄ ν•μ—μ„ μ„ νƒμ μΌλ΅ μν–‰λ¨**. 

  - **μ‚¬μ „ μ”μ²­μ€ "λΉ„λ‹¨μ(simple)" μ”μ²­**μ— λ€ν•΄ λΈλΌμ°μ €κ°€ μλ™μΌλ΅ μν–‰ (μ‚¬μ „ μ”μ²­μ μ‘μ„± λ° μν–‰μ€ κ°λ°μκ°€ μ§μ ‘ ν•λ” κ²ƒμ΄ μ•„λ‹λΌ, λΈλΌμ°μ €κ°€ μλ™μΌλ΅ μ²λ¦¬)

    > **λΉ„λ‹¨μ μ”μ²­κ³Ό λ‹¨μ μ”μ²­**
    >
    > - **λ‹¨μ μ”μ²­(Simple Request)**: 
    >   - νΉμ • μ΅°κ±΄μ„ λ§μ΅±ν•λ” μ”μ²­μ€ "λ‹¨μ μ”μ²­"μΌλ΅ κ°„μ£Όλλ©°, μ‚¬μ „ μ”μ²­ μ—†μ΄ μ§μ ‘ μ„λ²„μ— μ „μ†΅
    >   - λ‹¨μ μ”μ²­μ€ λ‹¤μκ³Ό κ°™μ€ μ΅°κ±΄μ„ λ¨λ‘ λ§μ΅±ν•΄μ•Ό ν•¨
    >     - HTTP λ©”μ„λ“κ°€ GET, HEAD, POST μ¤‘ ν•λ‚μ—¬μ•Ό ν•©λ‹λ‹¤.
    >     - HTTP ν—¤λ”λ” μ¤μ§ Accept, Accept-Language, Content-Language, Content-Type λ“± μ ν•λ μ§‘ν•©μ—μ„λ§ μ‚¬μ©ν•  μ μμΌλ©°, Content-Typeμ κ²½μ°μ—λ„ application/x-www-form-urlencoded, multipart/form-data, text/plain μ¤‘ ν•λ‚μ—¬μ•Ό ν•¨
    >     - Readmeμ™€ κ°™μ€ νΉμν• ν—¤λ”κ°€ ν¬ν•¨λμ–΄ μμ§€ μ•μ•„μ•Ό ν•©λ‹λ‹¤.
    >
    >
    > - **λΉ„λ‹¨μ μ”μ²­(Non-Simple Request)**
    >   - μ„μ μ΅°κ±΄λ“¤ μ¤‘ ν•λ‚λΌλ„ λ§μ΅±ν•μ§€ μ•λ” κ²½μ°, μ”μ²­μ€ "λΉ„λ‹¨μ μ”μ²­"μΌλ΅ λ¶„λ¥
    >   - μ΄λ¬ν• μ”μ²­μ€ μ‚¬μ „ μ”μ²­μ„ ν†µν•΄ μ„λ²„μ ν—κ°€λ¥Ό λ°›μ•„μ•Ό ν•¨
    >
    >



### π λΈλΌμ°μ €μ CORS κ²€μ¦ κ³Όμ •

#### 1. (μ‚¬μ „/μ‹¤μ ) μ‘λ‹µ ν—¤λ”μ μ•„λ λ‚΄μ©μ„ ν™•μΈν•μ—¬ λΈλΌμ°μ €κ°€ CORS ν—μ©μ„ κ²°μ •ν•¨

1. **`Access-Control-Allow-Origin` ν™•μΈ**
   - μ΄ ν—¤λ”λ” λ¦¬μ†μ¤μ— μ ‘κ·Όν•  μ μλ” μ¶μ²λ¥Ό λ…μ‹
   - μλ¥Ό λ“¤μ–΄, `Access-Control-Allow-Origin: https://example.com`μ€ `https://example.com` μ¶μ²μ—μ„λ§ λ¦¬μ†μ¤ μ ‘κ·Όμ„ ν—μ©ν•λ‹¤λ” κ²ƒμ„ μλ―Έ
   - **μ„λ²„κ°€ μ‘λ‹µμ— ν¬ν•¨μ‹ν‚¨ μ΄ ν—¤λ”μ κ°’μ΄ μ”μ²­μ„ λ³΄λ‚Έ νμ΄μ§€μ μ¶μ²μ™€ μΌμΉν•κ±°λ‚, λ¨λ“  μ¶μ²(`*`)λ¥Ό ν—μ©ν•λ” κ²½μ°μ—λ§, λΈλΌμ°μ €λ” μ”μ²­μ„ ν—μ©**
   - λ§μ•½ μ΄ ν—¤λ”κ°€ λ„λ½λμ—κ±°λ‚ μ¶μ²κ°€ μΌμΉν•μ§€ μ•λ”λ‹¤λ©΄, λΈλΌμ°μ €λ” CORS μ •μ±… μ„λ°μΌλ΅ μΈν•΄ μ”μ²­μ„ μ°¨λ‹¨ν•©λ‹λ‹¤.
2. **μ‹¤μ λ΅λ” λ” λ§μ€ ν—¤λ”λ¥Ό κ²€μ‚¬ν•μ—¬ CORS ν—μ© μ—¬λ¶€λ¥Ό κ²°μ •ν•¨ (μΈν„°λ„· μ°Έκ³ )**
   - μ—¬κΈ°μ„λ” κ·Έλƒ¥ κ°„λµν•κ²λ§ μ μ–΄λ†¨μ



### π“ƒ λ¦¬λ²„μ¤ ν”„λ΅μ‹ μ„λ²„λ¥Ό μ‚¬μ©ν•λ” κ²½μ°μ CORS μ²λ¦¬μ— λ€ν• κµ¬μ²΄μ μΈ κ³Όμ •

#### 0. κ²°λ΅ 

- λΈλΌμ°μ €λ” CORS μ •μ±…μ„ κ²€μ¦ν•  λ•, λ¦¬λ²„μ¤ ν”„λ΅μ‹ μ„λ²„μ μ‘λ‹µμ΄λ“ , λ°±μ—”λ“ μ„λ²„μ μ‘λ‹µμ΄λ“  κ·Έ μ¶μ²κ°€ μ–΄λ””μΈμ§€λ” μ¤‘μ”ν•μ§€ μ•μ. **μ¤‘μ”ν• κ²ƒμ€ μ‘λ‹µ ν—¤λ”, νΉν `Access-Control-Allow-Origin` ν—¤λ”μ λ‚΄μ©**. μ΄ ν—¤λ”μ— μ”μ²­μ„ λ³΄λ‚Έ μ¶μ²κ°€ λ…μ‹λμ–΄ μκ±°λ‚ λ¨λ“  μ¶μ²(`*`)κ°€ ν—μ©λλ‹¤λ©΄, λΈλΌμ°μ €λ” CORSλ¥Ό ν—μ©λ κ²ƒμΌλ΅ νλ‹¨ν•κ³  ν•΄λ‹Ή μ”μ²­μ„ μ§„ν–‰μ‹ν‚΄

#### μμ‹ : **ν΄λΌμ΄μ–ΈνΈκ°€ A λ°μ΄ν„°λ¥Ό ν¬ν•¨ν• μ”μ²­μ„ λ³΄λ‚΄κ³ , λ°±μ—”λ“ μ„λ²„λ” μ΄λ¥Ό μ²λ¦¬ν• ν›„ B λ°μ΄ν„°λ¥Ό μ‘λ‹µμΌλ΅ λ°ν™ν•λ” μƒν™© κ°€μ •**

#### 1. λ¦¬λ²„μ¤ ν”„λ΅μ‹ μ„λ²„μ— CORS ν—¤λ”λ¥Ό μ¶”κ°€ν•λ” κ²½μ°

1. **ν΄λΌμ΄μ–ΈνΈ μ”μ²­ λ°μƒ**: ν΄λΌμ΄μ–ΈνΈ(μ›Ή λΈλΌμ°μ €)κ°€ A λ°μ΄ν„°λ¥Ό ν¬ν•¨ν•μ—¬ λ¦¬λ²„μ¤ ν”„λ΅μ‹(Nginx)μ— μ”μ²­
2. **λ¦¬λ²„μ¤ ν”„λ΅μ‹μ—μ„ μ”μ²­ μ²λ¦¬**: λ¦¬λ²„μ¤ ν”„λ΅μ‹κ°€ μ”μ²­μ„ λ°›κ³  μ„¤μ •μ— λ”°λΌ λ°±μ—”λ“ μ„λ²„λ΅ μ „λ‹¬
3. **λ°±μ—”λ“ μ„λ²„μ—μ„ μ”μ²­ μ²λ¦¬**: λ°±μ—”λ“ μ„λ²„(Spring μ• ν”λ¦¬μΌ€μ΄μ… λ“±)μ—μ„ μ”μ²­μ„ λ°›μ•„ A λ°μ΄ν„°λ¥Ό DBμ— μ €μ¥ν•κ³ , μ‘λ‹µμΌλ΅ B λ°μ΄ν„°λ¥Ό μƒμ„±
4. **μ‘λ‹µμ΄ λ¦¬λ²„μ¤ ν”„λ΅μ‹λ΅ λ°ν™**: λ°±μ—”λ“ μ„λ²„μ μ‘λ‹µ(B λ°μ΄ν„°)μ΄ λ¦¬λ²„μ¤ ν”„λ΅μ‹λ΅ λ‹¤μ‹ μ „λ‹¬
5. **λ¦¬λ²„μ¤ ν”„λ΅μ‹μ—μ„ CORS ν—¤λ” μ¶”κ°€**: λ¦¬λ²„μ¤ ν”„λ΅μ‹κ°€ μ‘λ‹µμ— CORS κ΄€λ ¨ ν—¤λ”(`Access-Control-Allow-Origin` λ“±)λ¥Ό μ¶”κ°€
6. **ν΄λΌμ΄μ–ΈνΈμ— μ‘λ‹µ μ „λ‹¬**: μμ •λ μ‘λ‹µμ΄ ν΄λΌμ΄μ–ΈνΈμ—κ² μ „λ‹¬
7. **μ›Ή λΈλΌμ°μ €μ—μ„ CORS κ²€μ‚¬**: ν΄λΌμ΄μ–ΈνΈ(μ›Ή λΈλΌμ°μ €)λ” μ‘λ‹µμ CORS ν—¤λ”λ¥Ό κ²€μ‚¬ν•μ—¬ μ •μ±…μ„ μ¶©μ΅±ν•λ”μ§€ ν™•μΈ
8. **CORS μ •μ±… μ¶©μ΅± μ—¬λ¶€μ— λ”°λ¥Έ μ²λ¦¬**: μ¶©μ΅±ν•λ©΄ B λ°μ΄ν„°μ— μ ‘κ·Όν•  μ μκ³ , μ¶©μ΅±ν•μ§€ μ•μΌλ©΄ μ ‘κ·Όμ΄ μ°¨λ‹¨

#### 2. λ°±μ—”λ“ μ„λ²„μ—μ„ CORS ν—¤λ”λ¥Ό μ¶”κ°€ν• κ²½μ°:

1. **ν΄λΌμ΄μ–ΈνΈ μ”μ²­ λ°μƒ**: ν΄λΌμ΄μ–ΈνΈ(μ›Ή λΈλΌμ°μ €)κ°€ A λ°μ΄ν„°λ¥Ό ν¬ν•¨ν•μ—¬ λ¦¬λ²„μ¤ ν”„λ΅μ‹(Nginx)μ— μ”μ²­

2. **λ¦¬λ²„μ¤ ν”„λ΅μ‹μ—μ„ μ”μ²­ μ²λ¦¬**: λ¦¬λ²„μ¤ ν”„λ΅μ‹κ°€ μ”μ²­μ„ λ°›κ³  μ„¤μ •μ— λ”°λΌ λ°±μ—”λ“ μ„λ²„λ΅ μ „λ‹¬

3. **λ°±μ—”λ“ μ„λ²„μ—μ„ μ”μ²­ μ²λ¦¬ λ° CORS ν—¤λ” μ¶”κ°€**: λ°±μ—”λ“ μ„λ²„μ—μ„λ” A λ°μ΄ν„°λ¥Ό μ²λ¦¬(μ: DB μ €μ¥)ν•κ³ , μ‘λ‹µμΌλ΅ B λ°μ΄ν„°λ¥Ό λ°ν™ν•λ©΄μ„ μ‘λ‹µμ— CORS ν—¤λ”λ¥Ό ν¬ν•¨

4. **μ‘λ‹µμ΄ λ¦¬λ²„μ¤ ν”„λ΅μ‹λ¥Ό κ±°μ³ ν΄λΌμ΄μ–ΈνΈλ΅ μ „λ‹¬**: λ°±μ—”λ“ μ„λ²„μ μ‘λ‹µμ΄ λ¦¬λ²„μ¤ ν”„λ΅μ‹λ¥Ό κ±°μ³ ν΄λΌμ΄μ–ΈνΈμ—κ² μ „μ†΅. λ¦¬λ²„μ¤ ν”„λ΅μ‹λ” λ°±μ—”λ“μ—μ„ μ„¤μ •ν• CORS ν—¤λ”λ¥Ό μ μ§€.

5. **μ›Ή λΈλΌμ°μ €μ—μ„ CORS κ²€μ‚¬**: ν΄λΌμ΄μ–ΈνΈ(μ›Ή λΈλΌμ°μ €)λ” μ‘λ‹µμ CORS ν—¤λ”λ¥Ό κ²€μ‚¬ν•μ—¬ μ •μ±…μ„ μ¶©μ΅±ν•λ”μ§€ ν™•μΈ

6. **CORS μ •μ±… μ¶©μ΅± μ—¬λ¶€μ— λ”°λ¥Έ μ²λ¦¬**: μ¶©μ΅±ν•λ©΄ B λ°μ΄ν„°μ— μ ‘κ·Όν•  μ μκ³ , μ¶©μ΅±ν•μ§€ μ•μΌλ©΄ μ ‘κ·Όμ΄ μ°¨λ‹¨

> λ‘ κ²½μ° λ¨λ‘ μµμΆ…μ μΌλ΅ ν΄λΌμ΄μ–ΈνΈμ—μ„ λ°›μ€ μ‘λ‹µμ CORS ν—¤λ”λ¥Ό λ°”νƒ•μΌλ΅ μ›Ή λΈλΌμ°μ €κ°€ CORS μ •μ±… μ„λ° μ—¬λ¶€λ¥Ό νλ‹¨ν•λ©°, μ΄ κ³Όμ •μ—μ„ μ”μ²­ μ¶μ²μ™€ μ‘λ‹µμ `Access-Control-Allow-Origin` ν—¤λ” κ°’μ΄ μΌμΉν•λ”μ§€κ°€ ν•µμ‹¬