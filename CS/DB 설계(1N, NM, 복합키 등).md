# DB 설계(1:N, N:M, 복합키 등)

### ▣ 1:N , N:1
- **핵심**: 한 테이블의 레코드가 다른 테이블의 여러 레코드와 관련될 수 있음.
- **외래키 위치**: 'N' 쪽에 외래 키를 둠으로써 데이터 중복과 일관성 유지 문제를 방지.
- **예시**: `부서테이블(부서ID, 부서명)`과 `직원 테이블(직원ID, 이름, 부서ID 외래키)`. 한 부서에 여러 직원이 속할 수 있으며, 직원 테이블에 `외래키(부서ID)`를 포함시켜 각 직원이 어느 부서에 속하는지를 나타냅니다.
- **1 : N 관계에서 1쪽에 외래키를 두면 안되는 이유**
  - **데이터 중복**: 한 부서에 여러 직원이 속하는 경우, 그 부서를 여러 번 반복하여 기록해야 합니다. 예를 들어, 부서 A에 직원 1, 직원 2가 속한다면, 부서 A에 대한 정보(부서명 등)를 직원 수만큼 중복하여 저장해야 합니다.
  - **일관성 유지 문제**: 부서 정보가 변경될 경우, 해당 부서에 속한 모든 레코드를 찾아 일일이 업데이트해야 합니다. 이는 데이터 일관성 유지를 어렵게 만들고, 실수로 인한 데이터 불일치의 가능성을 증가시킵니다.

### ▣ N:M (다대다) 관계
- **핵심**: 두 테이블의 레코드가 서로 다수의 레코드와 관련될 수 있음.
- **연결 테이블 사용**: `연결(중간) 테이블`을 통해 `N:M 관계`를 두 개의 `1:N 관계`로 분해.
- **예시**: `학생 테이블(학생ID, 이름)`과 `강좌 테이블(강좌ID, 강좌명)` 사이의 관계. 여기서, `학생_강좌 연결 테이블(학생ID 외래키, 코스ID 외래키)`을 사용하여 각 학생이 수강하는 코스와 각 코스를 수강하는 학생을 나타냅니다.

### ▣ 기본키 (Primary Key)

- **핵심**: 테이블 내의 각 레코드를 유일하게 식별할 수 있는 키.
- **특징**: 유일성과 무결성을 보장해야 함.
- **예시**: `학생` 테이블에서 `학생ID`가 기본키로 사용됩니다. 이는 각 학생을 유일하게 식별합니다.

### ▣ 외래키 (Foreign Key)

- **핵심**: 다른 테이블의 레코드를 참조하는 키.
- **목적**: 테이블 간의 관계를 정립하고 데이터 무결성을 유지.
- **예시**: `직원` 테이블에서 `부서ID`는 외래키로, `부서` 테이블의 기본키 `부서ID`를 참조합니다.

### ▣ 복합키 (Composite Key)

- **핵심**: 두 개 이상의 컬럼을 결합하여 레코드를 유일하게 식별하는 키.
- **사용 상황**: 단일 키만으로는 레코드를 유일하게 식별할 수 없을 때 사용.
- **예시**: `학생_강좌` 연결 테이블에서 `학생ID`와 `코스ID`의 조합이 복합키로 사용됩니다.

### ▣ 서로게이트키 (Surrogate Key)

- **핵심**: 비즈니스 의미가 없고, 데이터베이스 내에서 레코드를 유일하게 식별하기 위해 시스템이 생성한 인위적인 키.

- **장점**: 비즈니스 로직의 변경에 영향을 받지 않고, 유일성과 무결성 관리가 용이.

- **예시**: 자동 증가하는 ID 필드가 서로게이트 키로 사용.

  - **연결 테이블**: `학생_강좌`

  - 필드
    - `등록ID` (서로게이트 키, 주 키)
    - `학생ID` (외래 키)
    - `강좌ID` (외래 키)
    - 추가 정보 (예: 등록 날짜, 성적 등)
  - 이 경우, `등록ID`는 각 등록 이벤트를 유일하게 식별하는 데 사용되며, 복합키(`학생ID`와 `강좌ID`의 조합)를 대체