# 자율 프로젝트 고민 사항 모음

### 1. Fcm 토큰의 경우 로그인 할 때 User 서버에서 요청 받지만, Notification 서버와 연결된 DB(몽고)로 저장해야 되는데 어떻게?

- 각 서버의 독립성을 생각해보면 자녀 ID와 Fcm 토큰을 Kafka에 넣고 Notification에서 수신해서 저장하도록 하는게 제일 바람직해 보임 -> 이 방법이 아니면 결국 Notification 서비스가 내려갔을 때 자녀 회원 가입에 영향을 미치게 됨

### 2. 회원 가입 시 탈퇴 유저의 레코드 확인하는 로직 추가 

- 탈퇴 유저의 LoginID, PhoneNumber, DeviceId는 다시 쓸 수 있어야 됨

  - a. 필드에 Unique 속성을 빼고, 회원 가입 시 마다 중복을 검사하는 로직 돌리기
    - 특징 : 새로운 레코드가 테이블에 추가되는 방식이기 때문에, 한 번 가입된 유저는 테이블에 기록이 전부 남아 있음

  - b. 회원 가입 시 is_deleted가 True인 레코드가 존재한다면 해당 레코드를 update하고 is_deleted를 False로 바꾸기
    - 특징 : 특정 레코드가 Update가 되는 방식이기 때문에, Update 이전 레코드의 정보는 사라짐

- **a로 채택** : Soft Delete를 사용하는 이유가 유저 기록을 남겨두기 위해서인데 b로 선택하면 이전 레코드가 없어지니 의미가 없어짐
  - b의 경우 문제점 :  A유저가 “test”라는 LoginID를 사용하다가 탈퇴 ->  B유저가 “test”라는 LoginID로 가입 -> A유저 복구 불가